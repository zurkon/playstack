import{B as T,M as W,a as B,C as q,c as g,S as j,O as P,W as A,A as N,D as R,j as D,r as I,R as K,b as V}from"./vendor.123023d1.js";const X=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}};X();const p={HEIGHT:1,WIDTH:4,DEPTH:4},L=(e,t,n,i,o,s,c)=>{const h=new T(i,p.HEIGHT,o),f=new q(`hsl(${140+s*5}, 100%, 60%)`),w=new W({color:f}),b=new B(h,w);b.position.set(e,t,n);const k=new g.exports.Box(new g.exports.Vec3(i/2,p.HEIGHT/2,o/2)),v=c?5:0,y=new g.exports.Body({mass:v,shape:k});return y.position.set(e,t,n),{block:b,body:y,width:i,depth:o}},Z=(e,t,n,i)=>{const o=e.direction,s=o==="x"?t:e.width,c=o==="z"?t:e.depth;e.width=s,e.depth=c,e.block.scale[o]=t/n,e.block.position[o]-=i/2,e.body.position[o]-=i/2;const h=new g.exports.Box(new g.exports.Vec3(s/2,p.HEIGHT/2,c/2));e.body.shapes=[],e.body.addShape(h)},F=e=>{const t=new T(4,12,4),n=new W({color:8126381}),i=new B(t,n);i.position.set(0,-6.5,0),e.add(i)},$=()=>{const e=document.querySelector("#container"),t=e.clientWidth/e.clientHeight,n=t<.7?.7:t,i=25,o=new j,s=new P(.5*i*n/-2,.5*i*n/2,i*n/2,i*n/-2,1,100);s.position.set(5,5,5),s.lookAt(0,0,0),s.position.y=10;const c=new A({antialias:!0,alpha:!0});return c.setSize(e.clientWidth,e.clientHeight),c.setClearColor(0,0),{scene:o,camera:s,renderer:c}},J=()=>{const e=new N(16777215,.5),t=new R(16777215,.5);return t.position.set(10,20,0),[e,t]};let a=[],H=[];const S=(e,t,{x:n,z:i},o,s,c)=>{const h=p.HEIGHT*a.length,f=L(n,h,i,o,s,a.length,!1);f.direction=c,e.add(f.block),t.addBody(f.body),a.push(f)},z=(e,t,n,i,o,s)=>{const c=p.HEIGHT*(a.length-1),h=L(n,c,i,o,s,a.length-1,!0);e.add(h.block),t.addBody(h.body),H.push(h)},Q=()=>{a=[],H=[]};let x=!1,E=!1,r,u,m,l;const U=e=>{l=new g.exports.World,l.gravity.set(0,-10,0),l.broadphase=new g.exports.NaiveBroadphase,l.solver.iterations=40,{scene:r,camera:u,renderer:m}=$();const[t,n]=J();F(r),S(r,l,{x:0,z:0},p.WIDTH,p.DEPTH),S(r,l,{x:-10,z:0},p.WIDTH,p.DEPTH,"x"),r.add(t),r.add(n),m.render(r,u),e.current.appendChild(m.domElement)},Y=()=>{const e=.15,t=a[a.length-1];t.block.position[t.direction]+=e,t.body.position[t.direction]+=e,t.block.position.x>10&&x==!0&&(z(r,l,t.block.position.x,t.block.position.z,t.width,t.depth),l.remove(t.body),r.remove(t.block),x=!1,document.querySelector("#gameover").style.display="flex",E=!0),u.position.y<p.HEIGHT*(a.length-2)+4&&(u.position.y+=e),_(),m.render(r,u)},_=()=>{l.step(1/60),H.forEach(e=>{e.block.position.copy(e.body.position),e.block.quaternion.copy(e.body.quaternion)})},ee=()=>{if(E&&document.location.reload(),!x)m.setAnimationLoop(Y),document.querySelector("#instructions").style.display="none",x=!0;else{const e=a[a.length-1],t=a[a.length-2],n=e.direction,i=e.block.position[n]-t.block.position[n],o=Math.abs(i),s=n==="x"?e.width:e.depth,c=s-o;if(c>0){Z(e,c,s,i);const h=(c/2+o/2)*Math.sign(i),f=n==="x"?e.block.position.x+h:e.block.position.x,w=n==="z"?e.block.position.z+h:e.block.position.z,b=n==="x"?o:e.width,k=n==="z"?o:e.depth;z(r,l,f,w,b,k);const v=n==="x"?e.block.position.x:-10,y=n==="z"?e.block.position.z:-10,G=e.width,O=e.depth,M=n==="x"?"z":"x";document.querySelector("#score").innerText=a.length-1,S(r,l,{x:v,z:y},G,O,M)}else z(r,l,e.block.position.x,e.block.position.z,e.width,e.depth),l.remove(e.body),r.remove(e.block),document.querySelector("#gameover").style.display="flex",E=!0}},te=()=>{const e=document.querySelector("#container"),t=e.clientWidth/e.clientHeight,n=25;u.left=.5*n*t/-2,u.right=.5*n*t/2,u.updateProjectionMatrix(),m.setSize(e.clientWidth,e.clientHeight),m.render(r,u)},oe=e=>{e.current.firstChild&&e.current.removeChild(e.current.firstChild),m.dispose()},d=D.exports.jsx,C=D.exports.jsxs,ne=()=>{const e=I.exports.useRef();return I.exports.useEffect(()=>(U(e),window.addEventListener("click",ee),window.addEventListener("resize",te),()=>{console.log("unmount"),oe(e),Q()}),[]),d("div",{id:"container",ref:e})},se=()=>d("div",{id:"gameover",style:{display:"none"},children:C("div",{className:"content",children:[d("h1",{children:"Game Over"}),d("p",{children:"Click to play again."})]})}),ie=()=>d("div",{id:"instructions",style:{display:"flex"},children:C("div",{className:"content",children:[d("p",{children:"Stack the blocks on top of each other"}),d("p",{children:"Click when a block is above the stack. How high can you reach?"}),d("p",{children:"Click to start game"})]})}),ce=()=>d("div",{id:"score",children:"0"});function re(){return C("div",{className:"App",children:[d(ie,{}),d(se,{}),d(ce,{}),d(ne,{})]})}K.render(d(V.StrictMode,{children:d(re,{})}),document.getElementById("root"));
